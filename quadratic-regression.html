<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ringkasan Regresi Kuadratik</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            color: #334155; /* Dark slate gray text */
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 2rem;
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 2.5rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .section-title {
            font-size: 2.25rem; /* 36px */
            font-weight: 700; /* Bold */
            color: #1e3a8a; /* Darker blue */
            margin-bottom: 1.5rem;
            border-bottom: 3px solid #60a5fa; /* Blue accent underline */
            padding-bottom: 0.5rem;
        }
        .subsection-title {
            font-size: 1.75rem; /* 28px */
            font-weight: 600; /* Semi-bold */
            color: #3b82f6; /* Medium blue */
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        .math-formula {
            background-color: #e0f2fe; /* Lightest blue */
            border-left: 5px solid #3b82f6; /* Blue border */
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            font-family: 'Inter', sans-serif; /* Maintain Inter font */
            font-size: 1.125rem; /* 18px */
            color: #1e40af; /* Dark blue for formula */
            overflow-x: auto; /* Allow horizontal scrolling for long formulas */
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
        }
        th, td {
            border: 1px solid #cbd5e1; /* Light gray border */
            padding: 0.75rem;
            text-align: left;
        }
        th {
            background-color: #bfdbfe; /* Lighter blue for table headers */
            font-weight: 600;
            color: #1e40af; /* Dark blue for table header text */
        }
        td {
            background-color: #eff6ff; /* Even lighter blue for table cells */
        }
        ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        .button-primary {
            background-color: #3b82f6; /* Blue */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            transition: background-color 0.3s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        .button-primary:hover {
            background-color: #2563eb; /* Darker blue on hover */
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-sizing: border-box; /* Include padding in width */
        }
        .result-area p {
            margin-bottom: 0.5rem;
        }
        .error-message {
            color: #ef4444; /* Red color for error messages */
            font-weight: 600;
            margin-top: 1rem;
        }
        .footer {
            text-align: center;
            padding: 2rem;
            color: #64748b; /* Gray text */
            font-size: 0.9rem;
        }
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            background-color: #cbd5e1; /* Placeholder background */
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        .video-container iframe,
        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        .video-placeholder {
            display: flex;
            flex-direction: column; /* Allow text stacking */
            justify-content: center;
            align-items: center;
            height: 100%;
            background-color: #e2e8f0;
            color: #4a5568;
            font-size: 1.2rem;
            text-align: center;
            padding: 1rem;
            border-radius: 8px;
        }
        /* Style for step-by-step results */
        .step-by-step-results {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            display: none; /* Hidden by default */
        }
        .step-by-step-results h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1e3a8a;
        }
        .step-by-step-results ul {
            list-style-type: none;
            margin-left: 0;
        }
        .step-by-step-results ul li {
            margin-bottom: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px dashed #cbd5e1;
        }
        .step-by-step-results ul li:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .step-by-step-results .math-formula {
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        /* Canvas specific styles */
        #regressionCanvas {
            width: 100%;
            max-width: 600px; /* Max width for larger screens */
            height: auto; /* Maintain aspect ratio */
            background-color: #ffffff;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            margin-top: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: block; /* To remove extra space below canvas */
            margin-left: auto; /* Center the canvas */
            margin-right: auto; /* Center the canvas */
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            .section-title {
                font-size: 1.75rem;
            }
            .subsection-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="text-center py-8">
            <h1 class="text-5xl font-extrabold text-blue-900 leading-tight">Regresi Kuadratik</h1>
            <p class="text-lg text-blue-700 mt-2">Memahami Metode Kuadrat Terkecil untuk Polinomial Orde 2</p>
            <a href="#uji-coba-section" class="button-primary mt-6 inline-block">Mulai Uji Coba Regresi Anda</a>
        </header>

        <main>
            <section class="card">
                <h2 class="section-title">Video Pembahasan</h2>
                <div class="video-container">
                    <!-- Video from the provided GitHub raw link -->
                    <video controls src="https://github.com/Eundxipro/statistika/raw/main/XIV.%20Video%20contoh%20Regresi%20Kuadratik%20Metode%20Kuadrat%20Terkecil%20(1).mp4">
                        Browser Anda tidak mendukung tag video. Silakan unduh video untuk menontonnya:
                        <a href="https://github.com/Eundxipro/statistika/raw/main/XIV.%20Video%20contoh%20Regresi%20Kuadratik%20Metode%20Kuadrat%20Terkecil%20(1).mp4">Unduh Video</a>
                    </video>
                </div>
            </section>

            <section class="card">
                <h2 class="section-title">Pendahuluan</h2>
                <p class="text-lg">Regresi Kuadratik adalah metode regresi yang menggunakan fungsi polinomial orde 2 untuk memodelkan hubungan antara variabel independen ($x$) dan variabel dependen ($y$). Bentuk grafiknya menyerupai kurva parabola. Metode ini sangat berguna ketika data yang tersebar menunjukkan pola non-linear.</p>
                <p class="mt-4 text-lg">Dalam video ini, kita mempelajari bagaimana menerapkan Metode Kuadrat Terkecil (Least-Square Method) untuk menemukan koefisien fungsi regresi kuadratik dan menghitung koefisien determinasi ($R^2$) yang menunjukkan seberapa baik model sesuai dengan data.</p>
            </section>

            <section class="card">
                <h2 class="section-title">Fungsi Regresi Kuadratik</h2>
                <p class="text-lg">Fungsi regresi kuadratik memiliki bentuk umum:</p>
                <div class="math-formula">
                    $$ \hat{y} = a + bx + cx^2 $$
                </div>
                <p class="text-lg">Di mana:
                    <ul>
                        <li>$\hat{y}$ adalah nilai $y$ yang diprediksi.</li>
                        <li>$x$ adalah variabel independen.</li>
                        <li>$a$, $b$, dan $c$ adalah koefisien regresi yang perlu dicari.</li>
                    </ul>
                </p>

                <h3 class="subsection-title">Menemukan Koefisien dengan Metode Kuadrat Terkecil</h3>
                <p class="text-lg">Koefisien $a$, $b$, dan $c$ dapat ditemukan dengan menyelesaikan sistem persamaan linear berikut dalam bentuk matriks:</p>
                <div class="math-formula">
                    $$
                    \begin{bmatrix}
                    n & \Sigma x & \Sigma x^2 \\
                    \Sigma x & \Sigma x^2 & \Sigma x^3 \\
                    \Sigma x^2 & \Sigma x^3 & \Sigma x^4
                    \end{bmatrix}
                    \begin{bmatrix}
                    a \\
                    b \\
                    c
                    \end{bmatrix}
                    =
                    \begin{bmatrix}
                    \Sigma y \\
                    \Sigma xy \\
                    \Sigma x^2y
                    \end{bmatrix}
                    $$
                </div>
                <p class="text-lg">Di mana $n$ adalah jumlah titik data.</p>
            </section>

            <section class="card">
                <h2 class="section-title">Koefisien Determinasi ($R^2$)</h2>
                <p class="text-lg">Koefisien determinasi, dilambangkan dengan $R^2$ (atau $r^2$), adalah ukuran seberapa baik model regresi sesuai dengan data. Nilainya berkisar antara 0 dan 1.</p>
                <p class="text-lg">Formulanya adalah:</p>
                <div class="math-formula">
                    $$ R^2 = 1 - \frac{\Sigma (y - \hat{y})^2}{\Sigma (y - \bar{y})^2} $$
                </div>
                <p class="text-lg">Di mana:
                    <ul>
                        <li>$\Sigma (y - \hat{y})^2$ adalah jumlah kuadrat sisaan (Sum of Squares of Residuals).</li>
                        <li>$\Sigma (y - \bar{y})^2$ adalah jumlah kuadrat total (Total Sum of Squares), dengan $\bar{y}$ adalah rata-rata nilai $y$.</li>
                    </ul>
                </p>
                <h3 class="subsection-title">Interpretasi Nilai $R^2$</h3>
                <ul>
                    <li><strong>$R^2 = 0$:</strong> Model regresi tidak menjelaskan variasi variabel $y$ sama sekali.</li>
                    <li><strong>$R^2$ mendekati $0$:</strong> Model regresi hanya sedikit menjelaskan variasi variabel $y$.</li>
                    <li><strong>$R^2$ mendekati $1$:</strong> Model regresi banyak menjelaskan variasi variabel $y$.</li>
                    <li><strong>$R^2 = 1$:</strong> Model regresi secara tepat menjelaskan variasi variabel $y$.</li>
                </ul>
            </section>

            <section class="card">
                <h2 class="section-title">Contoh Soal dan Solusi</h2>
                <p class="text-lg">Diberikan data berikut:</p>
                <table>
                    <thead>
                        <tr>
                            <th>x</th>
                            <th>y</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>0</td><td>2</td></tr>
                        <tr><td>1</td><td>8</td></tr>
                        <tr><td>2</td><td>14</td></tr>
                        <tr><td>3</td><td>27</td></tr>
                        <tr><td>4</td><td>41</td></tr>
                        <tr><td>5</td><td>61</td></tr>
                    </tbody>
                </table>
                <p class="text-lg"><strong>Tugas:</strong> Cari fungsi regresi kuadratik ($\hat{y}$) dan hitung nilai koefisien determinasi ($R^2$).</p>

                <h3 class="subsection-title">Langkah-langkah Perhitungan:</h3>
                <ol class="list-decimal ml-6 mt-4">
                    <li>
                        <p class="text-lg font-semibold">Menghitung Jumlah yang Diperlukan (dari Tabel):</p>
                        <ul>
                            <li>$n = 6$</li>
                            <li>$\Sigma x = 15$</li>
                            <li>$\Sigma y = 153$</li>
                            <li>$\Sigma xy = 586$</li>
                            <li>$\Sigma x^2 = 55$</li>
                            <li>$\Sigma x^2y = 2.488$</li>
                            <li>$\Sigma x^3 = 225$</li>
                            <li>$\Sigma x^4 = 979$</li>
                        </ul>
                    </li>
                    <li>
                        <p class="text-lg font-semibold">Memasukkan nilai ke Sistem Persamaan Linear:</p>
                        <div class="math-formula">
                            $$
                            \begin{bmatrix}
                            6 & 15 & 55 \\
                            15 & 55 & 225 \\
                            55 & 225 & 979
                            \end{bmatrix}
                            \begin{bmatrix}
                            a \\
                            b \\
                            c
                            \end{bmatrix}
                            =
                            \begin{bmatrix}
                            153 \\
                            586 \\
                            2.488
                            \end{bmatrix}
                            $$
                        </div>
                    </li>
                    <li>
                        <p class="text-lg font-semibold">Menyelesaikan Sistem Persamaan Linear (menggunakan Aturan Cramer):</p>
                        <ul>
                            <li>$D = 3.920$</li>
                            <li>$D_1 = 9.800$</li>
                            <li>$D_2 = 9.884$</li>
                            <li>$D_3 = 7.140$</li>
                            <li>$a = D_1 / D = 9.800 / 3.920 = 2.5$</li>
                            <li>$b = D_2 / D = 9.884 / 3.920 \approx 2.5214$</li>
                            <li>$c = D_3 / D = 7.140 / 3.920 \approx 1.8214$</li>
                        </ul>
                    </li>
                    <li>
                        <p class="text-lg font-semibold">Menyusun Fungsi Regresi Kuadratik:</p>
                        <div class="math-formula">
                            $$ \hat{y} = 2.5 + 2.5214x + 1.8214x^2 $$
                        </div>
                    </li>
                    <li>
                        <p class="text-lg font-semibold">Menghitung Koefisien Determinasi ($R^2$):</p>
                        <ul>
                            <li>$\Sigma (y - \hat{y})^2 = 3.2283$</li>
                            <li>$\bar{y} = \Sigma y / n = 153 / 6 = 25.5$</li>
                            <li>$\Sigma (y - \bar{y})^2 = 2493.5$</li>
                            <li>$R^2 = 1 - (3.2283 / 2493.5) \approx 0.9987$</li>
                        </ul>
                    </li>
                </ol>
                <h3 class="subsection-title">Kesimpulan Contoh Soal:</h3>
                <p class="text-lg">Fungsi regresi kuadratik yang diperoleh adalah $y\hat{} = 2.5 + 2.5214x + 1.8214x^2$.</p>
                <p class="text-lg">Koefisien determinasi ($R^2$) adalah $0.9987$. Nilai ini sangat dekat dengan 1, menunjukkan bahwa model regresi ini sangat baik dalam menjelaskan variasi variabel $y$ dari data yang diberikan.</p>
                <p class="mt-4 text-lg">Visualisasi data tersebar dan kurva regresi kuadratik akan menunjukkan kurva parabola yang melewati titik-titik data, mencerminkan kecocokan model yang tinggi.</p>
            </section>

            <section id="uji-coba-section" class="card">
                <h2 class="section-title">Uji Coba Regresi Kuadratik Anda</h2>
                <p class="text-lg mb-4">Masukkan data $X$ dan $Y$ Anda (pisahkan dengan koma), lalu klik "Hitung Regresi" untuk melihat proses perhitungan dan hasilnya.</p>
                <div class="form-group">
                    <label for="xValues">Nilai X (contoh: 0,1,2,3,4,5):</label>
                    <textarea id="xValues" rows="3" placeholder="Masukkan nilai X dipisahkan dengan koma"></textarea>
                </div>
                <div class="form-group">
                    <label for="yValues">Nilai Y (contoh: 2,8,14,27,41,61):</label>
                    <textarea id="yValues" rows="3" placeholder="Masukkan nilai Y dipisahkan dengan koma"></textarea>
                </div>
                <button id="calculateRegression" class="button-primary">Hitung Regresi</button>
                <div id="errorMessage" class="error-message hidden"></div>

                <!-- Step-by-step results section -->
                <div id="stepByStepResults" class="step-by-step-results">
                    <h4>Langkah-langkah Perhitungan:</h4>
                    <ul>
                        <li>
                            <p class="font-semibold">Langkah 1: Menghitung Jumlah yang Diperlukan</p>
                            <p>Setelah mengumpulkan data X dan Y, langkah pertama adalah menghitung berbagai jumlah (sigma) yang dibutuhkan untuk sistem persamaan linear:</p>
                            <ul class="ml-4">
                                <li>Jumlah Data (n): <strong><span id="step_n"></span></strong></li>
                                <li>&Sigma;X: <strong><span id="step_sumX"></span></strong></li>
                                <li>&Sigma;Y: <strong><span id="step_sumY"></span></strong></li>
                                <li>&Sigma;X&sup2;: <strong><span id="step_sumX2"></span></strong></li>
                                <li>&Sigma;X&sup3;: <strong><span id="step_sumX3"></span></strong></li>
                                <li>&Sigma;X&sup4;: <strong><span id="step_sumX4"></span></strong></li>
                                <li>&Sigma;XY: <strong><span id="step_sumXY"></span></strong></li>
                                <li>&Sigma;X&sup2;Y: <strong><span id="step_sumX2Y"></span></strong></li>
                            </ul>
                        </li>
                        <li>
                            <p class="font-semibold">Langkah 2: Membentuk Matriks Sistem Persamaan Linear</p>
                            <p>Jumlah-jumlah di atas digunakan untuk membentuk matriks koefisien (M) dan vektor konstanta (B) dari sistem persamaan linear:</p>
                            <p>Matriks Koefisien (M):</p>
                            <div class="math-formula" id="matrix_M_display">
                                <!-- MathJax will render this dynamically -->
                            </div>
                            <p>Vektor Konstanta (B):</p>
                            <div class="math-formula" id="vector_B_display">
                                <!-- MathJax will render this dynamically -->
                            </div>
                        </li>
                        <li>
                            <p class="font-semibold">Langkah 3: Menghitung Determinan (Menggunakan Aturan Cramer)</p>
                            <p>Untuk menemukan koefisien (a, b, c), kita perlu menghitung determinan dari matriks M (D) dan determinan dari matriks yang dimodifikasi (Da, Db, Dc):</p>
                            <ul class="ml-4">
                                <li>Determinan D: <strong><span id="step_D"></span></strong></li>
                                <li>Determinan D<sub>a</sub>: <strong><span id="step_Da"></span></strong></li>
                                <li>Determinan D<sub>b</sub>: <strong><span id="step_Db"></span></strong></li>
                                <li>Determinan D<sub>c</sub>: <strong><span id="step_Dc"></span></strong></li>
                            </ul>
                        </li>
                        <li>
                            <p class="font-semibold">Langkah 4: Menghitung Koefisien Regresi (a, b, c)</p>
                            <p>Koefisien dihitung dengan membagi determinan yang sesuai dengan determinan D:</p>
                            <ul class="ml-4">
                                <li>Koefisien a = D<sub>a</sub> / D: <strong><span id="step_a_calc"></span></strong></li>
                                <li>Koefisien b = D<sub>b</sub> / D: <strong><span id="step_b_calc"></span></strong></li>
                                <li>Koefisien c = D<sub>c</sub> / D: <strong><span id="step_c_calc"></span></strong></li>
                            </ul>
                            <p>Sehingga fungsi regresi kuadratik yang ditemukan adalah: <strong id="intermediate_regression_equation"></strong></p>
                        </li>
                        <li>
                            <p class="font-semibold">Langkah 5: Menghitung Koefisien Determinasi (R&sup2;)</p>
                            <p>R&sup2; mengukur seberapa baik model sesuai dengan data. Perhitungan melibatkan rata-rata Y dan jumlah kuadrat selisih:</p>
                            <ul class="ml-4">
                                <li>Rata-rata Y (&bar;y): <strong><span id="step_yBar"></span></strong></li>
                                <li>&Sigma;(y - &hat;y)&sup2; (Jumlah Kuadrat Sisaan): <strong><span id="step_sumY_hat_diff_sq"></span></strong></li>
                                <li>&Sigma;(y - &bar;y)&sup2; (Jumlah Kuadrat Total): <strong><span id="step_sumY_bar_diff_sq"></span></strong></li>
                                <li>R&sup2; = 1 - (&Sigma;(y - &hat;y)&sup2; / &Sigma;(y - &bar;y)&sup2;): <strong><span id="step_rSquared_calc"></span></strong></li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div id="results" class="result-area mt-8 border p-6 rounded-lg bg-blue-50 border-blue-200">
                    <h3 class="subsection-title">Hasil Akhir:</h3>
                    <p><strong>Jumlah Data (n):</strong> <span id="nResult"></span></p>
                    <p><strong>Koefisien a:</strong> <span id="aResult"></span></p>
                    <p><strong>Koefisien b:</strong> <span id="bResult"></span></p>
                    <p><strong>Koefisien c:</strong> <span id="cResult"></span></p>
                    <p><strong>Fungsi Regresi ($\hat{y}$):</strong> <span id="regressionEquation"></span></p>
                    <p><strong>Koefisien Determinasi ($R^2$):</strong> <span id="rSquaredResult"></span></p>
                </div>

                <div id="plotArea" class="mt-8 p-6 bg-white rounded-lg shadow-md" style="display: none;">
                    <h3 class="subsection-title">Visualisasi Data & Kurva Regresi:</h3>
                    <canvas id="regressionCanvas" width="600" height="400"></canvas>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>&copy; 2025 Ringkasan Regresi Kuadratik. Dibuat berdasarkan video MathemNesus.</p>
        </footer>
    </div>

    <!-- MathJax for rendering LaTeX formulas -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const xValuesInput = document.getElementById('xValues');
            const yValuesInput = document.getElementById('yValues');
            const calculateButton = document.getElementById('calculateRegression');
            const errorMessageDiv = document.getElementById('errorMessage');
            
            // Final results spans
            const nResultSpan = document.getElementById('nResult');
            const aResultSpan = document.getElementById('aResult');
            const bResultSpan = document.getElementById('bResult');
            const cResultSpan = document.getElementById('cResult');
            const regressionEquationSpan = document.getElementById('regressionEquation');
            const rSquaredResultSpan = document.getElementById('rSquaredResult');
            const resultsDiv = document.getElementById('results');

            // Step-by-step results spans
            const stepByStepResultsDiv = document.getElementById('stepByStepResults');
            const step_n = document.getElementById('step_n');
            const step_sumX = document.getElementById('step_sumX');
            const step_sumY = document.getElementById('step_sumY');
            const step_sumX2 = document.getElementById('step_sumX2');
            const step_sumX3 = document.getElementById('step_sumX3');
            const step_sumX4 = document.getElementById('step_sumX4');
            const step_sumXY = document.getElementById('step_sumXY');
            const step_sumX2Y = document.getElementById('step_sumX2Y');

            const matrix_M_display = document.getElementById('matrix_M_display');
            const vector_B_display = document.getElementById('vector_B_display');

            const step_D = document.getElementById('step_D');
            const step_Da = document.getElementById('step_Da');
            const step_Db = document.getElementById('step_Db');
            const step_Dc = document.getElementById('step_Dc');

            const step_a_calc = document.getElementById('step_a_calc');
            const step_b_calc = document.getElementById('step_b_calc');
            const step_c_calc = document.getElementById('step_c_calc');
            const intermediate_regression_equation = document.getElementById('intermediate_regression_equation');


            const step_yBar = document.getElementById('step_yBar');
            const step_sumY_hat_diff_sq = document.getElementById('step_sumY_hat_diff_sq');
            const step_sumY_bar_diff_sq = document.getElementById('step_sumY_bar_diff_sq');
            const step_rSquared_calc = document.getElementById('step_rSquared_calc');

            // Plotting elements
            const plotArea = document.getElementById('plotArea');
            const canvas = document.getElementById('regressionCanvas');
            const ctx = canvas.getContext('2d');
            let currentXData = [];
            let currentYData = [];
            let currentA, currentB, currentC;


            // Hide results sections initially
            resultsDiv.style.display = 'none';
            stepByStepResultsDiv.style.display = 'none';
            plotArea.style.display = 'none';


            calculateButton.addEventListener('click', calculateQuadraticRegression);

            // Function to resize canvas and redraw plot
            function resizeCanvas() {
                const parentWidth = canvas.parentElement.clientWidth;
                canvas.width = Math.min(parentWidth, 600); // Max 600px width
                canvas.height = canvas.width * (2/3); // Maintain 3:2 aspect ratio

                if (currentXData.length > 0 && currentYData.length > 0) {
                    drawPlot(currentXData, currentYData, currentA, currentB, currentC);
                }
            }

            window.addEventListener('resize', resizeCanvas);


            function showErrorMessage(message) {
                errorMessageDiv.textContent = message;
                errorMessageDiv.classList.remove('hidden');
                resultsDiv.style.display = 'none';
                stepByStepResultsDiv.style.display = 'none';
                plotArea.style.display = 'none';
            }

            function hideErrorMessage() {
                errorMessageDiv.classList.add('hidden');
            }

            function parseAndValidateInput(inputString) {
                return inputString.split(',').map(s => {
                    const num = parseFloat(s.trim());
                    if (isNaN(num)) {
                        throw new Error("Input tidak valid. Pastikan semua nilai adalah angka.");
                    }
                    return num;
                });
            }

            // Function to calculate determinant of a 3x3 matrix
            function determinant3x3(matrix) {
                return (
                    matrix[0][0] * (matrix[1][1] * matrix[2][2] - matrix[1][2] * matrix[2][1]) -
                    matrix[0][1] * (matrix[1][0] * matrix[2][2] - matrix[1][2] * matrix[2][0]) +
                    matrix[0][2] * (matrix[1][0] * matrix[2][1] - matrix[1][1] * matrix[2][0])
                );
            }

            function calculateQuadraticRegression() {
                hideErrorMessage();
                resultsDiv.style.display = 'none';
                stepByStepResultsDiv.style.display = 'none';
                plotArea.style.display = 'none';


                let xData, yData;
                try {
                    xData = parseAndValidateInput(xValuesInput.value);
                    yData = parseAndValidateInput(yValuesInput.value);
                } catch (error) {
                    showErrorMessage(error.message);
                    return;
                }

                if (xData.length === 0 || yData.length === 0) {
                    showErrorMessage("Masukkan setidaknya satu pasang nilai X dan Y.");
                    return;
                }

                if (xData.length !== yData.length) {
                    showErrorMessage("Jumlah nilai X dan Y harus sama.");
                    return;
                }

                if (xData.length < 3) {
                    showErrorMessage("Diperlukan setidaknya 3 pasang data untuk regresi kuadratik.");
                    return;
                }

                const n = xData.length;

                // Calculate sums
                let sumX = 0, sumY = 0, sumX2 = 0, sumX3 = 0, sumX4 = 0, sumXY = 0, sumX2Y = 0;
                
                for (let i = 0; i < n; i++) {
                    const x = xData[i];
                    const y = yData[i];

                    sumX += x;
                    sumY += y;
                    sumX2 += x * x;
                    sumX3 += x * x * x;
                    sumX4 += x * x * x * x;
                    sumXY += x * y;
                    sumX2Y += x * x * y;
                }

                // Construct matrices for Cramer's Rule
                const M = [
                    [n, sumX, sumX2],
                    [sumX, sumX2, sumX3],
                    [sumX2, sumX3, sumX4]
                ];

                const B = [sumY, sumXY, sumX2Y];

                const D = determinant3x3(M);

                if (D === 0) {
                    showErrorMessage("Determinan matriks adalah nol. Regresi tidak dapat dihitung dengan data ini.");
                    return;
                }

                // Calculate Da, Db, Dc
                const Ma = [
                    [B[0], M[0][1], M[0][2]],
                    [B[1], M[1][1], M[1][2]],
                    [B[2], M[2][1], M[2][2]]
                ];
                const Da = determinant3x3(Ma);

                const Mb = [
                    [M[0][0], B[0], M[0][2]],
                    [M[1][0], B[1], M[1][2]],
                    [M[2][0], B[2], M[2][2]]
                ];
                const Db = determinant3x3(Mb);

                const Mc = [
                    [M[0][0], M[0][1], B[0]],
                    [M[1][0], M[1][1], B[1]],
                    [M[2][0], M[2][1], B[2]]
                ];
                const Dc = determinant3x3(Mc);

                const a = Da / D;
                const b = Db / D;
                const c = Dc / D;

                // Calculate R-squared components
                let sumY_hat_diff_sq = 0; // Sigma (y - y_hat)^2
                let sumY_bar_diff_sq = 0; // Sigma (y - y_bar)^2
                const yBar = sumY / n;

                for (let i = 0; i < n; i++) {
                    const x = xData[i];
                    const y = yData[i];
                    const yHat = a + b * x + c * x * x;

                    sumY_hat_diff_sq += (y - yHat) * (y - yHat);
                    sumY_bar_diff_sq += (y - yBar) * (y - yBar);
                }

                let rSquared = 0;
                if (sumY_bar_diff_sq !== 0) {
                    rSquared = 1 - (sumY_hat_diff_sq / sumY_bar_diff_sq);
                } else {
                    rSquared = 1; // Perfect fit if all y values are identical
                }

                // Store current data for redrawing on resize
                currentXData = xData;
                currentYData = yData;
                currentA = a;
                currentB = b;
                currentC = c;


                // Display step-by-step results
                step_n.textContent = n;
                step_sumX.textContent = sumX.toFixed(4);
                step_sumY.textContent = sumY.toFixed(4);
                step_sumX2.textContent = sumX2.toFixed(4);
                step_sumX3.textContent = sumX3.toFixed(4);
                step_sumX4.textContent = sumX4.toFixed(4);
                step_sumXY.textContent = sumXY.toFixed(4);
                step_sumX2Y.textContent = sumX2Y.toFixed(4);

                // Update matrix LaTeX strings dynamically
                matrix_M_display.innerHTML = `
                    $$ M = \\begin{bmatrix} n & \\Sigma x & \\Sigma x^2 \\\\ \\Sigma x & \\Sigma x^2 & \\Sigma x^3 \\\\ \\Sigma x^2 & \\Sigma x^3 & \\Sigma x^4 \\end{bmatrix} = \\begin{bmatrix} ${n} & ${sumX.toFixed(4)} & ${sumX2.toFixed(4)} \\\\ ${sumX.toFixed(4)} & ${sumX2.toFixed(4)} & ${sumX3.toFixed(4)} \\\\ ${sumX2.toFixed(4)} & ${sumX3.toFixed(4)} & ${sumX4.toFixed(4)} \\end{bmatrix} $$
                `;
                vector_B_display.innerHTML = `
                    $$ B = \\begin{bmatrix} \\Sigma y \\\\ \\Sigma xy \\\\ \\Sigma x^2y \\end{bmatrix} = \\begin{bmatrix} ${sumY.toFixed(4)} \\\\ ${sumXY.toFixed(4)} \\\\ ${sumX2Y.toFixed(4)} \\end{bmatrix} $$
                `;


                step_D.textContent = D.toFixed(4);
                step_Da.textContent = Da.toFixed(4);
                step_Db.textContent = Db.toFixed(4);
                step_Dc.textContent = Dc.toFixed(4);

                step_a_calc.textContent = `${Da.toFixed(4)} / ${D.toFixed(4)} = ${a.toFixed(4)}`;
                step_b_calc.textContent = `${Db.toFixed(4)} / ${D.toFixed(4)} = ${b.toFixed(4)}`;
                step_c_calc.textContent = `${Dc.toFixed(4)} / ${D.toFixed(4)} = ${c.toFixed(4)}`;
                intermediate_regression_equation.innerHTML = `&hat;y = ${a.toFixed(4)} + ${b.toFixed(4)}x + ${c.toFixed(4)}x<sup>2</sup>`;


                step_yBar.textContent = yBar.toFixed(4);
                step_sumY_hat_diff_sq.textContent = sumY_hat_diff_sq.toFixed(4);
                step_sumY_bar_diff_sq.textContent = sumY_bar_diff_sq.toFixed(4);
                step_rSquared_calc.textContent = `1 - (${sumY_hat_diff_sq.toFixed(4)} / ${sumY_bar_diff_sq.toFixed(4)}) = ${rSquared.toFixed(4)}`;

                stepByStepResultsDiv.style.display = 'block'; // Show step-by-step results

                // Display final results
                nResultSpan.textContent = n;
                aResultSpan.textContent = a.toFixed(4);
                bResultSpan.textContent = b.toFixed(4);
                cResultSpan.textContent = c.toFixed(4);
                regressionEquationSpan.innerHTML = `&hat;y = ${a.toFixed(4)} + ${b.toFixed(4)}x + ${c.toFixed(4)}x<sup>2</sup>`;
                rSquaredResultSpan.textContent = rSquared.toFixed(4);

                resultsDiv.style.display = 'block'; // Show final results section
                plotArea.style.display = 'block'; // Show plot area

                // Initial canvas resizing and plot drawing
                resizeCanvas();
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, "stepByStepResults"]);
            }

            // --- Plotting Logic ---
            function drawPlot(xData, yData, a, b, c) {
                ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas

                const padding = 40; // Padding for axes
                const chartWidth = canvas.width - 2 * padding;
                const chartHeight = canvas.height - 2 * padding;

                // Find min/max for scaling
                const minX = Math.min(...xData);
                const maxX = Math.max(...xData);
                const minY = Math.min(...yData);
                const maxY = Math.max(...yData);

                // Add some margin to the min/max values for better visualization
                const dataRangeX = maxX - minX;
                const dataRangeY = maxY - minY;
                const paddedMinX = minX - dataRangeX * 0.1;
                const paddedMaxX = maxX + dataRangeX * 0.1;
                const paddedMinY = minY - dataRangeY * 0.1;
                const paddedMaxY = maxY + dataRangeY * 0.1;

                const scaleX = chartWidth / (paddedMaxX - paddedMinX);
                const scaleY = chartHeight / (paddedMaxY - paddedMinY);

                // Function to transform data coordinates to canvas coordinates
                function toCanvasX(val) {
                    return padding + (val - paddedMinX) * scaleX;
                }

                function toCanvasY(val) {
                    return canvas.height - padding - (val - paddedMinY) * scaleY;
                }

                // Draw Axes
                ctx.beginPath();
                ctx.strokeStyle = '#64748b'; // Gray for axes
                ctx.lineWidth = 2;
                // X-axis
                ctx.moveTo(padding, toCanvasY(paddedMinY));
                ctx.lineTo(padding + chartWidth, toCanvasY(paddedMinY));
                // Y-axis
                ctx.moveTo(padding, toCanvasY(paddedMinY));
                ctx.lineTo(padding, toCanvasY(paddedMaxY));
                ctx.stroke();

                // Draw axis labels and ticks (simplified)
                ctx.fillStyle = '#334155';
                ctx.font = '12px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('X', padding + chartWidth / 2, canvas.height - 10);
                ctx.textAlign = 'left';
                ctx.fillText('Y', 10, padding + chartHeight / 2);

                // Draw scatter points
                ctx.fillStyle = '#ef4444'; // Red for scatter points
                xData.forEach((x, i) => {
                    ctx.beginPath();
                    ctx.arc(toCanvasX(x), toCanvasY(yData[i]), 4, 0, Math.PI * 2);
                    ctx.fill();
                });

                // Draw quadratic regression curve
                ctx.beginPath();
                ctx.strokeStyle = '#3b82f6'; // Blue for regression curve
                ctx.lineWidth = 3;

                // Draw curve by sampling points across the X range
                const step = (paddedMaxX - paddedMinX) / 100; // 100 steps for smoothness
                for (let x = paddedMinX; x <= paddedMaxX; x += step) {
                    const yHat = a + b * x + c * x * x;
                    if (x === paddedMinX) {
                        ctx.moveTo(toCanvasX(x), toCanvasY(yHat));
                    } else {
                        ctx.lineTo(toCanvasX(x), toCanvasY(yHat));
                    }
                }
                ctx.stroke();
            }
        });
    </script>
</body>
</html>
